@model CursinhoEACH.Models.PersonViewModel
@{
    ViewData["Title"] = "Detalhes da pessoa";
    bool isAluno = Model.Papel == "Aluno";
    bool isProfessor = Model.Papel == "Professor";
    bool showMotivo = isAluno && Model.Matriculado == false && !string.IsNullOrWhiteSpace(Model.MotivoDesligamento);
}

<p class="text-muted">Visualização dos dados cadastrados com os mesmos campos do formulário de criação. Todos estão desabilitados.</p>

<form class="needs-validation" novalidate autocomplete="off" id="detailsForm">
    <div class="card mb-3">
        <div class="card-body">
            <h6 class="mb-3">Dados básicos</h6>
            <div class="row g-3">
                <div class="col-12 col-md-6">
                    <label for="Papel" class="form-label">Papel <span class="text-danger only-edit" aria-hidden="true">*</span><span class="visually-hidden"> (obrigatório)</span></label>
                    <select class="form-select" id="Papel" name="Papel" disabled required>
                        @if(Model.Papel=="Aluno"){<option value="Aluno" selected>Aluno</option>} else {<option value="Aluno">Aluno</option>}
                        @if(Model.Papel=="Professor"){<option value="Professor" selected>Professor</option>} else {<option value="Professor">Professor</option>}
                        @if(Model.Papel=="Responsável"){<option value="Responsável" selected>Responsável</option>} else {<option value="Responsável">Responsável</option>}
                    </select>
                </div>
                <div class="col-12 col-md-6">
                    <label for="CPF" class="form-label">CPF <span class="text-danger only-edit" aria-hidden="true">*</span><span class="visually-hidden"> (obrigatório)</span></label>
                    <input type="text" class="form-control cpf-mask" id="CPF" name="CPF" value="@(Model.CPF ?? "")" disabled required pattern="^\d{3}\.\d{3}\.\d{3}-\d{2}$" title="Formato: 000.000.000-00" data-validate-cpf="true" maxlength="14" />
                </div>
                <div class="col-12 col-md-6">
                    <label for="Nome" class="form-label">Nome <span class="text-danger only-edit" aria-hidden="true">*</span><span class="visually-hidden"> (obrigatório)</span></label>
                    <input type="text" class="form-control" id="Nome" name="Nome" value="@Model.Nome" disabled required maxlength="100" pattern="^(?:[A-Za-zÀ-ÖØ-öø-ÿ]{2,}\s+[A-Za-zÀ-ÖØ-öø-ÿ]{2,}(?:\s+[A-Za-zÀ-ÖØ-öø-ÿ]{2,})*)$" title="Informe nome e sobrenome (mínimo 2 letras cada)." />
                    <div class="invalid-feedback">Informe o nome.</div>
                </div>
                <div class="col-12 col-md-6">
                    <label for="Email" class="form-label">Email <span class="text-danger only-edit" aria-hidden="true">*</span><span class="visually-hidden"> (obrigatório)</span></label>
                    <input type="email" class="form-control" id="Email" name="Email" value="@Model.Email" disabled required maxlength="100" data-validate-email="true" />
                    <div class="invalid-feedback">Informe um email válido.</div>
                </div>
                <div class="col-12 col-md-6">
                    <label for="DataNascimento" class="form-label">Data de nascimento</label>
                    <input type="text" class="form-control" id="DataNascimento" name="DataNascimento" value="@(Model.DataNascimento ?? "")" disabled inputmode="numeric" maxlength="10" />
                </div>
                <div class="col-12 col-md-6">
                    <label for="Telefone" class="form-label">Telefone</label>
                    <input type="text" class="form-control" id="Telefone" name="Telefone" value="@(Model.Telefone ?? "")" disabled inputmode="tel" maxlength="15" />
                </div>
                <div class="col-12">
                    <label for="Endereco" class="form-label">Endereço</label>
                    <input type="text" class="form-control" id="Endereco" name="Endereco" value="@(Model.Endereco ?? "")" disabled maxlength="255" />
                </div>
            </div>
        </div>
    </div>

    @if(isAluno){
    <div class="card mb-3" id="cardOutrasInfo">
        <div class="card-body">
            <h6 class="mb-3">Dados de aluno</h6>
            <div class="row g-3">
                <div class="col-12 col-md-3">
                    <label for="RepresentanteLegalCPF" class="form-label">Representante legal (CPF) <span class="text-danger only-edit" aria-hidden="true">*</span><span class="visually-hidden"> (obrigatório)</span></label>
                    <input type="text" class="form-control cpf-mask" id="RepresentanteLegalCPF" name="RepresentanteLegalCPF" value="@(Model.RepresentanteLegalCPF ?? "")" disabled pattern="^\d{3}\.\d{3}\.\d{3}-\d{2}$" title="Formato: 000.000.000-00" data-validate-cpf="true" maxlength="14" />
                    <div class="invalid-feedback">Informe o CPF do representante legal.</div>
                </div>
                <div class="col-12 col-md-3">
                    <label for="Turma" class="form-label">Turma <span class="text-danger only-edit" aria-hidden="true">*</span><span class="visually-hidden"> (obrigatório)</span></label>
                        <select class="form-select" id="Turma" name="Turma" disabled>
                            @{ 
                                var turmaValor = (Model.AnoTurma != null && Model.PeriodoTurma != null) ? ($"{Model.AnoTurma} {Model.PeriodoTurma}") : ""; 
                                string[] opcoesTurma = new[]{"2025 Matutino","2025 Vespertino","2025 Noturno","2024 Matutino","2024 Vespertino","2024 Noturno"}; 
                            }
                            @if(string.IsNullOrEmpty(turmaValor)){<option value="" disabled selected>Selecione...</option>} else {<option value="" disabled>Selecione...</option>}
                            @foreach(var op in opcoesTurma){ if(op==turmaValor){<option value="@op" selected>@op</option>} else {<option value="@op">@op</option>} }
                        </select>
                    <div class="invalid-feedback">Selecione a turma.</div>
                </div>
                <div class="col-12 col-md-3">
                    <label for="AnoEscolar" class="form-label">Ano escolar</label>
                    <input type="number" class="form-control" id="AnoEscolar" name="AnoEscolar" value="@(Model.AnoEscolar?.ToString() ?? "")" disabled min="1" max="4" step="1" />
                </div>
                <div class="col-12 col-md-3">
                    <label for="Matriculado" class="form-label">Matriculado</label>
                    <div class="form-check form-switch mt-1">
                        <input class="form-check-input" type="checkbox" id="Matriculado" name="Matriculado" value="true" @(Model.Matriculado == true ? "checked" : "") disabled>
                        <label class="form-check-label" for="Matriculado">Sim/Não</label>
                    </div>
                </div>
            </div>
            <div class="row g-3 mt-1">
                <div class="col-12 @(showMotivo?"":"d-none")" id="wrapMotivoDesligamento">
                    <label for="MotivoDesligamento" class="form-label">Motivo desligamento <span class="text-danger only-edit" aria-hidden="true">*</span><span class="visually-hidden"> (obrigatório)</span></label>
                    <input type="text" class="form-control" id="MotivoDesligamento" name="MotivoDesligamento" value="@(Model.MotivoDesligamento ?? "")" disabled minlength="10" maxlength="100" />
                    <div class="invalid-feedback">Informe o motivo do desligamento (mínimo 10 caracteres).</div>
                </div>
            </div>
        </div>
    </div>
    }
    @if(isProfessor){
    <div class="card mb-3" id="cardProfessor">
        <div class="card-body">
            <h6 class="mb-3">Dados de professor</h6>
            <div class="row g-3">
                <div class="col-12 col-md-6">
                    <label for="TipoProfessor" class="form-label">Tipo de professor <span class="text-danger only-edit" aria-hidden="true">*</span><span class="visually-hidden"> (obrigatório)</span></label>
                    <select class="form-select" id="TipoProfessor" name="TipoProfessor" disabled>
                        @if(string.IsNullOrWhiteSpace(Model.TipoProfessor)){<option value="" disabled selected>Selecione...</option>} else {<option value="" disabled>Selecione...</option>}
                        @if(Model.TipoProfessor=="Regular"){<option value="Regular" selected>Regular</option>} else {<option value="Regular">Regular</option>}
                        @if(Model.TipoProfessor=="Monitor"){<option value="Monitor" selected>Monitor</option>} else {<option value="Monitor">Monitor</option>}
                        @if(Model.TipoProfessor=="Plantonista"){<option value="Plantonista" selected>Plantonista</option>} else {<option value="Plantonista">Plantonista</option>}
                    </select>
                    <div class="invalid-feedback">Selecione o tipo de professor.</div>
                </div>
            </div>
        </div>
    </div>
    }

    <div class="d-flex justify-content-end gap-2">
        <button type="button" id="btnEditar" class="btn btn-brand text-white btn-no-focus">Editar</button>
        <button type="submit" id="btnSalvar" class="btn btn-brand text-white btn-no-focus d-none">Salvar</button>
        <button type="button" id="btnCancelar" class="btn btn-danger btn-no-focus d-none">Cancelar</button>
        <a asp-action="Index" class="btn btn-outline-secondary btn-no-focus" id="btnVoltar">Voltar</a>
    </div>
</form>

@* Script movido para site.js *@
